<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>The comprehensive Precipitation Generator — ComprehensivePrecipitationGenerator • RMAWGEN</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="The comprehensive Precipitation Generator — ComprehensivePrecipitationGenerator"><meta property="og:description" content="The comprehensive Precipitation Generator"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMAWGEN</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ecor/RMAWGEN/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>The comprehensive Precipitation Generator</h1>
    <small class="dont-index">Source: <a href="https://github.com/ecor/RMAWGEN/blob/HEAD/R/ComprehensivePrecipitationGenerator.R" class="external-link"><code>R/ComprehensivePrecipitationGenerator.R</code></a></small>
    <div class="hidden name"><code>ComprehensivePrecipitationGenerator.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The comprehensive Precipitation Generator</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ComprehensivePrecipitationGenerator</span><span class="op">(</span></span>
<span>  station <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T0001"</span>, <span class="st">"T0010"</span>, <span class="st">"T0099"</span><span class="op">)</span>,</span>
<span>  <span class="va">prec_all</span>,</span>
<span>  mean_climate_prec <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  year_max <span class="op">=</span> <span class="fl">1990</span>,</span>
<span>  year_min <span class="op">=</span> <span class="fl">1961</span>,</span>
<span>  leap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nmonth <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  cpf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  lag.max <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ic <span class="op">=</span> <span class="st">"AIC"</span>,</span>
<span>  activateVARselect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exogen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exogen_sim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  is_exogen_gaussian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  year_max_sim <span class="op">=</span> <span class="va">year_max</span>,</span>
<span>  year_min_sim <span class="op">=</span> <span class="va">year_min</span>,</span>
<span>  mean_climate_prec_sim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  onlygeneration <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  varmodel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type_quantile <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  qnull <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  valmin <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_GPCA_iteration <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_GPCA_iteration_residuals <span class="op">=</span> <span class="va">n_GPCA_iteration</span>,</span>
<span>  sample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extremes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  exogen_all <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exogen_all_col <span class="op">=</span> <span class="va">station</span>,</span>
<span>  no_spline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nscenario <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  noise <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nearPD <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-station">station<a class="anchor" aria-label="anchor" href="#arg-station"></a></dt>
<dd><p>character vector of the IDs of the considered meteorological stations</p></dd>


<dt id="arg-prec-all">prec_all<a class="anchor" aria-label="anchor" href="#arg-prec-all"></a></dt>
<dd><p>data frame containing daily precipitation of all meteorological stations. See <code><a href="trentino.html">PRECIPITATION</a></code> defined in the <code><a href="trentino.html">trentino</a></code> dataset for formatting.</p></dd>


<dt id="arg-mean-climate-prec">mean_climate_prec<a class="anchor" aria-label="anchor" href="#arg-mean-climate-prec"></a></dt>
<dd><p>a matrix containing monthly mean daily precipitation for the considered station. If it is <code>NULL</code>, it is calculated. See input of <code><a href="is.monthly.climate.html">is.monthly.climate</a></code></p></dd>


<dt id="arg-year-max">year_max<a class="anchor" aria-label="anchor" href="#arg-year-max"></a></dt>
<dd><p>start year of the recorded (calibration) period</p></dd>


<dt id="arg-year-min">year_min<a class="anchor" aria-label="anchor" href="#arg-year-min"></a></dt>
<dd><p>end year of the recorded (calibration) period</p></dd>


<dt id="arg-leap">leap<a class="anchor" aria-label="anchor" href="#arg-leap"></a></dt>
<dd><p>logical variables. If it is <code>TRUE</code> (default)(recommended), leap years are considered, otherwise all years have 365 days</p></dd>


<dt id="arg-nmonth">nmonth<a class="anchor" aria-label="anchor" href="#arg-nmonth"></a></dt>
<dd><p>number of months in one year (default is 12)</p></dd>


<dt id="arg-cpf">cpf<a class="anchor" aria-label="anchor" href="#arg-cpf"></a></dt>
<dd><p>see <code><a href="normalizeGaussian_severalstations.html">normalizeGaussian_severalstations</a></code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical variable</p></dd>


<dt id="arg-p-type-lag-max-ic-activatevarselect">p, type, lag.max, ic, activateVARselect<a class="anchor" aria-label="anchor" href="#arg-p-type-lag-max-ic-activatevarselect"></a></dt>
<dd><p>see respective input parameter on <code><a href="getVARmodel.html">getVARmodel</a></code></p></dd>


<dt id="arg-exogen">exogen<a class="anchor" aria-label="anchor" href="#arg-exogen"></a></dt>
<dd><p>data frame or matrix containing the (normalized or not) exogenous variables (predictors) for the recorded (calibration) period.</p></dd>


<dt id="arg-exogen-sim">exogen_sim<a class="anchor" aria-label="anchor" href="#arg-exogen-sim"></a></dt>
<dd><p>data frame or matrix containing the (normalized or not) exogenous variables (predictors) for the simulation period. Default is <code>NULL</code>. If it is <code>NULL</code>, it is replaced with <code>exogen</code> within the function.</p></dd>


<dt id="arg-is-exogen-gaussian">is_exogen_gaussian<a class="anchor" aria-label="anchor" href="#arg-is-exogen-gaussian"></a></dt>
<dd><p>logical value. If <code>TRUE</code>, <code>exogen_sim</code> and <code>exogen</code> are given as already normalized variables, otherwhise they are not normalized. Default is <code>FALSE</code></p></dd>


<dt id="arg-year-max-sim">year_max_sim<a class="anchor" aria-label="anchor" href="#arg-year-max-sim"></a></dt>
<dd><p>last year of the simulation period. Default is equal to <code>year_max</code></p></dd>


<dt id="arg-year-min-sim">year_min_sim<a class="anchor" aria-label="anchor" href="#arg-year-min-sim"></a></dt>
<dd><p>first year of the simulation period. Default is equal to <code>year_min</code></p></dd>


<dt id="arg-mean-climate-prec-sim">mean_climate_prec_sim<a class="anchor" aria-label="anchor" href="#arg-mean-climate-prec-sim"></a></dt>
<dd><p>a matrix containing monthly mean daily precipitation for the simulation period. If is <code>NULL</code> (Default), it is set equal to <code>mean_climate_prec</code>.</p></dd>


<dt id="arg-onlygeneration">onlygeneration<a class="anchor" aria-label="anchor" href="#arg-onlygeneration"></a></dt>
<dd><p>logical value. If <code>TRUE</code> the VAR model <code>varmodel</code> is given as input and only random generation is done, otherwise (default) is calculated from measured data</p></dd>


<dt id="arg-varmodel">varmodel<a class="anchor" aria-label="anchor" href="#arg-varmodel"></a></dt>
<dd><p>the comprehensinve VAR model as a <code><a href="varest2-class.html">varest2</a></code> S4 object or a <code>NULL</code> object. If <code>NULL</code> (default), the comprehensinve VAR is estimated from measured data within the function, otherwise it is given as input and only random generation is done.</p></dd>


<dt id="arg-type-quantile">type_quantile<a class="anchor" aria-label="anchor" href="#arg-type-quantile"></a></dt>
<dd><p>see <code>type</code> on <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code></p></dd>


<dt id="arg-step">step<a class="anchor" aria-label="anchor" href="#arg-step"></a></dt>
<dd><p>see <code><a href="normalizeGaussian_severalstations.html">normalizeGaussian_severalstations</a></code>. Default is 0.</p></dd>


<dt id="arg-n-gpca-iteration">n_GPCA_iteration<a class="anchor" aria-label="anchor" href="#arg-n-gpca-iteration"></a></dt>
<dd><p>number of iterations of Gaussianization process for data. Default is 0 (no Gaussianization)</p></dd>


<dt id="arg-n-gpca-iteration-residuals">n_GPCA_iteration_residuals<a class="anchor" aria-label="anchor" href="#arg-n-gpca-iteration-residuals"></a></dt>
<dd><p>number of iterations of Gaussianization process for VAR residuals. Default is 0 (no Gaussianization)</p></dd>


<dt id="arg-sample-extremes-qnull-valmin">sample, extremes, qnull, valmin<a class="anchor" aria-label="anchor" href="#arg-sample-extremes-qnull-valmin"></a></dt>
<dd><p>see <code><a href="normalizeGaussian_severalstations.html">normalizeGaussian_severalstations</a></code></p></dd>


<dt id="arg-exogen-all">exogen_all<a class="anchor" aria-label="anchor" href="#arg-exogen-all"></a></dt>
<dd><p>data frame containing exogenous variable formatted like <code>prec_all</code>. Default is <code>NULL</code>.
It is alternative to <code>exogen</code> and if it not <code>NULL</code>,<code>is_exogen_gaussian</code> is automatically set <code>FALSE</code></p></dd>


<dt id="arg-exogen-all-col">exogen_all_col<a class="anchor" aria-label="anchor" href="#arg-exogen-all-col"></a></dt>
<dd><p>vector of considered  columns of <code>exogen_all</code>. Default is <code>station</code>.</p></dd>


<dt id="arg-no-spline">no_spline<a class="anchor" aria-label="anchor" href="#arg-no-spline"></a></dt>
<dd><p>logical value. See <code><a href="splineInterpolateMonthlytoDailyforSeveralYears.html">splineInterpolateMonthlytoDailyforSeveralYears</a></code>. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-nscenario">nscenario<a class="anchor" aria-label="anchor" href="#arg-nscenario"></a></dt>
<dd><p>number of generated scenarios for daily maximum and minimum temperature</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>seed for stochastic random generation see <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>.</p></dd>


<dt id="arg-noise">noise<a class="anchor" aria-label="anchor" href="#arg-noise"></a></dt>
<dd><p>stochastic noise to add for variabile generation. Default is <code>NULL</code>. See <code><a href="newVARmultieventRealization.html">newVARmultieventRealization</a></code>. Not used in case that <code>nscenario&gt;1</code>.</p></dd>


<dt id="arg-nearpd">nearPD<a class="anchor" aria-label="anchor" href="#arg-nearpd"></a></dt>
<dd><p>logical. Default is <code>FALSE</code>. See <code><a href="getVARmodel.html">getVARmodel</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of the following variables:</p>

<p><code>prec_mes</code>        matrix containing measured daily precipitation (the data is copied by the measured data given as input for the period and the station considered for <code>varmodel</code> estimation)</p>
<p><code>prec_spline</code>      matrix containing climatic "spline-interpolated" daily preciptation from <code>mean_climate_prec</code></p>
<p><code>data_prec</code>        matrix containing normalized measured precipitation variable</p>
<p><code>prec_gen</code>          matrix containing generated daily precipitation [mm]</p>
<p><code>prec_spline_sim</code>   matrix containing climatic "spline-interpolated" daily preciptation from <code>mean_climate_prec_sim</code></p>
<p><code>data_prec_gen</code>            matrix containing normalized generated precipitation variable</p>
<p><code>mean_climate_prec</code>        matrix containing monthly means of daily precipitation (historical scenario)</p>
<p><code>mean_climate_prec_sim</code>    matrix containing monthly means of daily precipitation (predicted/simulated scenario)</p>
<p><code>var</code>                 a varest object containing the used VAR model</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>It pre-processes and generates a multi-site precipitation fields. It uses <code><a href="getVARmodel.html">getVARmodel</a></code>. Detailed examples can be viewed of this function in <a href="https://docs.google.com/file/d/0B66otCUk3Bv6V3RPbm1mUG4zVHc/edit" class="external-link">this presentation</a>.
Unfortunately, using this approach, the spatial correlations are underestimated. This is due to the persinstence of zeros in the precipitation records.
This problem is known in literature and can be solved in the future versions of RMAWGEN.
See the R code for further details</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="splineInterpolateMonthlytoDailyforSeveralYears.html">splineInterpolateMonthlytoDailyforSeveralYears</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Emanuele Cordano, Emanuele Eccel</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trentino</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1222</span><span class="op">)</span> <span class="co"># set the seed for random generations!</span></span></span>
<span class="r-in"><span><span class="va">year_max</span> <span class="op">&lt;-</span> <span class="fl">1990</span></span></span>
<span class="r-in"><span><span class="va">year_min</span> <span class="op">&lt;-</span> <span class="fl">1961</span></span></span>
<span class="r-in"><span><span class="va">year_max_sim</span> <span class="op">&lt;-</span> <span class="fl">1982</span></span></span>
<span class="r-in"><span><span class="va">year_min_sim</span> <span class="op">&lt;-</span> <span class="fl">1981</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_GPCA_iter</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">nscenario</span><span class="op">=</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">station</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T0090"</span>,<span class="st">"T0083"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Not Run: the call to ComprehensivePrecipitationGenerator may elapse too</span></span></span>
<span class="r-in"><span><span class="co">## long time (more than 5 eseconds) and is not executed  by default CRAN check.</span></span></span>
<span class="r-in"><span><span class="co">## Please uncomment the following line to run the example on your own PC.</span></span></span>
<span class="r-in"><span><span class="va">generation00</span> <span class="op">&lt;-</span> <span class="fu">ComprehensivePrecipitationGenerator</span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span>,</span></span>
<span class="r-in"><span>prec_all<span class="op">=</span><span class="va">PRECIPITATION</span>,year_min<span class="op">=</span><span class="va">year_min</span>,year_max<span class="op">=</span><span class="va">year_max</span>,</span></span>
<span class="r-in"><span>year_min_sim<span class="op">=</span><span class="va">year_min_sim</span>,year_max_sim<span class="op">=</span><span class="va">year_max_sim</span>,p<span class="op">=</span><span class="va">p</span>,</span></span>
<span class="r-in"><span>n_GPCA_iteration<span class="op">=</span><span class="va">n_GPCA_iter</span>,n_GPCA_iteration_residuals<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>sample<span class="op">=</span><span class="st">"monthly"</span>,nscenario<span class="op">=</span><span class="va">nscenario</span>,no_spline<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Emanuele Cordano, Emanuele Eccel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

